<!DOCTYPE html>
<html lang="fa" dir="rtl">
<!-- ... (بقیه head بدون تغییر) ... -->
<body>
  <!-- ... (بقیه body بدون تغییر) ... -->
  <script>
    const SUPABASE_URL = 'https://qdccjbakfuywvdqfcoyg.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFkY2NqYmFrZnV5d3ZkcWZjb3lnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYzNzk3MTEsImV4cCI6MjA2MTk1NTcxMX0.cwpbvCF3Qs3Mg1GAYPimijXnyDDzQERuTb_k2XZl5ZU';

    // تغییر در نحوه ایجاد کلاینت Supabase
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY, {
      headers: {
        'apikey': SUPABASE_KEY,
        'Authorization': `Bearer ${SUPABASE_KEY}`
      },
      auth: {
        autoRefreshToken: true,
        persistSession: true
      }
    });

    // ... (بقیه کد بدون تغییر) ...

    // اضافه کردن لاگ برای دیباگ
    async function loadExams() {
      try {
        examsList.innerHTML = 'در حال بارگذاری...';
        errorDiv.textContent = '';

        const { data: exams, error: examsError } = await supabase
          .from('exams')
          .select('id, title, max_attempts, active')
          .eq('active', true)
          .order('id', { ascending: false });

        console.log('Query Result:', { data: exams, error: examsError }); // اضافه کردن لاگ

        if (examsError) {
          console.error('Exams Error:', examsError); // اضافه کردن لاگ خطا
          errorDiv.textContent = 'خطا در دریافت لیست آزمون‌ها!';
          examsList.innerHTML = '';
          return;
        }

        // ... (بقیه تابع بدون تغییر) ...
      } catch (err) {
        console.error('Unexpected Error:', err); // اضافه کردن لاگ خطای کلی
        errorDiv.textContent = 'خطای غیرمنتظره در بارگیری آزمون‌ها!';
        examsList.innerHTML = '';
      }
    }

    // اطمینان از لود شدن Supabase
    window.addEventListener('load', () => {
      if (!window.supabase) {
        console.error('Supabase client not loaded!');
        errorDiv.textContent = 'خطا در بارگیری کتابخانه Supabase';
        return;
      }
      loadCustomLinks();
      loadExams();
    });
  </script>
</body>
</html>
